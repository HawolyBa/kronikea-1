{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Utilisateur\\\\Documents\\\\CODE\\\\kronikea-master\\\\pages\\\\story\\\\[id]\\\\chapter\\\\[chapid]\\\\index.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport Link from \"next/link\";\nimport { connect } from \"react-redux\";\nimport { useRouter } from \"next/router\";\nimport { Divider, Space, PageHeader, Tooltip, Spin } from \"antd\";\nimport { dummy } from \"../../../../../utils/dummy\";\nimport { useAuth } from \"../../../../../hooks/userHooks\";\nimport { getChapter, getComments, submitComment, deleteComment, rateStory, getUserNote } from \"../../../../../redux/actions/storiesActions\";\nimport Comments from \"../../../../../components/chapter/Comments\";\nimport LoadingScreen from \"../../../../../components/hoc/LoadingScreen\";\nimport RedirectComp from \"../../../../../components/hoc/RedirectComp\";\nimport { CharacterGrid, LocationGrid } from \"../../../../../components/common/Grid\";\nimport RateStory from \"../../../../../components/common/RateStory\";\n\nvar Chapter = function Chapter(props) {\n  _s();\n\n  var router = useRouter();\n  var auth = useAuth();\n  var loading = props.loading,\n      chapter = props.chapter,\n      loadingComments = props.loadingComments,\n      comments = props.comments,\n      chapterExists = props.chapterExists,\n      userNote = props.userNote;\n\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      characters = _React$useState2[0],\n      setCharacters = _React$useState2[1];\n\n  React.useEffect(function () {\n    props.getChapter(router.query.id, router.query.chapid, \"show\");\n    props.getComments(router.query.chapid);\n\n    if (!auth.isLoading) {\n      props.getUserNote(router.query.id);\n    }\n  }, [router.query.id, router.query.chapid, auth]);\n  React.useEffect(function () {\n    if (chapter.characters) {\n      setCharacters(chapter.characters.filter(function (c) {\n        return c[\"public\"] || c.authorId === auth.user.uid;\n      }));\n    }\n  }, [chapter]);\n  return __jsx(LoadingScreen, {\n    loading: loading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 5\n    }\n  }, __jsx(RedirectComp, {\n    condition: chapterExists && chapter.status,\n    type: \"404\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }, __jsx(RedirectComp, {\n    condition: chapter[\"public\"] || auth.user && auth.user.uid === chapter.authorId,\n    type: \"403\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"main-chapter\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"chapter-page\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }\n  }, __jsx(PageHeader, {\n    className: \"site-page-header\",\n    onBack: function onBack() {\n      return router.push(\"/story/\".concat(router.query.id));\n    },\n    title: \"Back to story\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 15\n    }\n  }), __jsx(\"h2\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 15\n    }\n  }, chapter.number, \". \", chapter.title), __jsx(\"div\", {\n    className: \"meta\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 15\n    }\n  }, __jsx(Divider, {\n    orientation: \"left\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }\n  }, __jsx(Link, {\n    href: \"/profile/1\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 19\n    }\n  }, __jsx(\"a\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 21\n    }\n  }, __jsx(Space, {\n    direction: \"vertical\",\n    align: \"center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 23\n    }\n  }, __jsx(\"div\", {\n    className: \"avatar\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 25\n    }\n  }, __jsx(\"img\", {\n    src: dummy.person,\n    alt: dummy.name,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 27\n    }\n  })), __jsx(\"h5\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 25\n    }\n  }, chapter.authorName)))))), __jsx(\"section\", {\n    className: \"chapter-content\",\n    dangerouslySetInnerHTML: {\n      __html: chapter.body\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 15\n    }\n  }), __jsx(\"div\", {\n    className: \"nav-btns\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 15\n    }\n  }, chapter.prev ? __jsx(Link, {\n    href: \"/story/\".concat(router.query.id, \"/chapter/\").concat(chapter.prev),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 19\n    }\n  }, __jsx(\"a\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 21\n    }\n  }, __jsx(Tooltip, {\n    title: \"Previous Chapter\",\n    placement: \"bottom\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 23\n    }\n  }, __jsx(\"div\", {\n    className: \"icon custom-icon nav-btn prev-btn\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 25\n    }\n  }, __jsx(\"ion-icon\", {\n    name: \"chevron-back-circle\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 27\n    }\n  }))))) : __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 19\n    }\n  }), chapter.next && __jsx(Link, {\n    href: \"/story/\".concat(router.query.id, \"/chapter/\").concat(chapter.next),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 19\n    }\n  }, __jsx(\"a\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 21\n    }\n  }, __jsx(Tooltip, {\n    title: \"Next Chapter\",\n    placement: \"bottom\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 23\n    }\n  }, __jsx(\"div\", {\n    className: \"icon custom-icon nav-btn next-btn\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 25\n    }\n  }, __jsx(\"ion-icon\", {\n    name: \"chevron-forward-circle\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 27\n    }\n  })))))), __jsx(Divider, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 15\n    }\n  }), loadingComments ? __jsx(Spin, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }\n  }) : __jsx(Comments, {\n    submitComment: props.submitComment,\n    auth: auth,\n    comments: comments,\n    deleteComment: props.deleteComment,\n    chapid: router.query.chapid,\n    storyId: router.query.id,\n    authorId: chapter.authorId,\n    title: chapter.storyTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  })), __jsx(\"div\", {\n    className: \"main-chapter-details\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }, __jsx(\"h3\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 15\n    }\n  }, \"Characters in this chapter\"), __jsx(CharacterGrid, {\n    gutter: \"12px\",\n    characters: characters,\n    type: \"show\",\n    columnsCountBreakPoints: {\n      350: 1,\n      750: 2,\n      900: 2,\n      1200: 2,\n      1600: 2\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 15\n    }\n  }), __jsx(Divider, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 15\n    }\n  }), __jsx(\"h3\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 15\n    }\n  }, \"Locations in this chapter\"), __jsx(LocationGrid, {\n    columnsCountBreakPoints: {\n      350: 1,\n      750: 2,\n      900: 2,\n      1200: 2,\n      1600: 2\n    },\n    gutter: \"12px\",\n    lg: 12,\n    md: 12,\n    sm: 12,\n    xs: 12,\n    type: \"story\",\n    locations: chapter.locations,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 15\n    }\n  })), auth.user && auth.user.uid && __jsx(RateStory, {\n    userNote: userNote,\n    note: chapter.note,\n    storyId: router.query.id,\n    rateFunc: props.rateStory,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 15\n    }\n  })))));\n};\n\n_s(Chapter, \"5bsPvzQv/qmU9u3u7Bc4zGtd4wo=\", false, function () {\n  return [useRouter, useAuth];\n});\n\n_c = Chapter;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    chapter: state.stories.chapter,\n    loading: state.stories.loading,\n    comments: state.stories.comments,\n    loadingComments: state.stories.loadingComments,\n    chapterExists: state.stories.chapterExists,\n    message: state.stories.message,\n    userNote: state.stories.userNote\n  };\n};\n\nexport default connect(mapStateToProps, {\n  getChapter: getChapter,\n  getComments: getComments,\n  submitComment: submitComment,\n  deleteComment: deleteComment,\n  getUserNote: getUserNote,\n  rateStory: rateStory\n})(Chapter);\n\nvar _c;\n\n$RefreshReg$(_c, \"Chapter\");","map":{"version":3,"sources":["C:/Users/Utilisateur/Documents/CODE/kronikea-master/pages/story/[id]/chapter/[chapid]/index.js"],"names":["React","Link","connect","useRouter","Divider","Space","PageHeader","Tooltip","Spin","dummy","useAuth","getChapter","getComments","submitComment","deleteComment","rateStory","getUserNote","Comments","LoadingScreen","RedirectComp","CharacterGrid","LocationGrid","RateStory","Chapter","props","router","auth","loading","chapter","loadingComments","comments","chapterExists","userNote","useState","characters","setCharacters","useEffect","query","id","chapid","isLoading","filter","c","authorId","user","uid","status","push","number","title","person","name","authorName","__html","body","prev","next","storyTitle","locations","note","mapStateToProps","state","stories","message"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Link from \"next/link\";\r\nimport { connect } from \"react-redux\";\r\nimport { useRouter } from \"next/router\";\r\nimport { Divider, Space, PageHeader, Tooltip, Spin } from \"antd\";\r\n\r\nimport { dummy } from \"../../../../../utils/dummy\";\r\nimport { useAuth } from \"../../../../../hooks/userHooks\";\r\nimport {\r\n  getChapter,\r\n  getComments,\r\n  submitComment,\r\n  deleteComment,\r\n  rateStory,\r\n  getUserNote,\r\n} from \"../../../../../redux/actions/storiesActions\";\r\n\r\nimport Comments from \"../../../../../components/chapter/Comments\";\r\nimport LoadingScreen from \"../../../../../components/hoc/LoadingScreen\";\r\nimport RedirectComp from \"../../../../../components/hoc/RedirectComp\";\r\nimport {\r\n  CharacterGrid,\r\n  LocationGrid,\r\n} from \"../../../../../components/common/Grid\";\r\nimport RateStory from \"../../../../../components/common/RateStory\";\r\n\r\nconst Chapter = (props) => {\r\n  const router = useRouter();\r\n  const auth = useAuth();\r\n  const {\r\n    loading,\r\n    chapter,\r\n    loadingComments,\r\n    comments,\r\n    chapterExists,\r\n    userNote,\r\n  } = props;\r\n\r\n  const [characters, setCharacters] = React.useState([]);\r\n\r\n  React.useEffect(() => {\r\n    props.getChapter(router.query.id, router.query.chapid, \"show\");\r\n    props.getComments(router.query.chapid);\r\n    if (!auth.isLoading) {\r\n      props.getUserNote(router.query.id);\r\n    }\r\n  }, [router.query.id, router.query.chapid, auth]);\r\n\r\n  React.useEffect(() => {\r\n    if (chapter.characters) {\r\n      setCharacters(\r\n        chapter.characters.filter(\r\n          (c) => c.public || c.authorId === auth.user.uid\r\n        )\r\n      );\r\n    }\r\n  }, [chapter]);\r\n\r\n  return (\r\n    <LoadingScreen loading={loading}>\r\n      <RedirectComp condition={chapterExists && chapter.status} type=\"404\">\r\n        <RedirectComp\r\n          condition={\r\n            chapter.public || (auth.user && auth.user.uid === chapter.authorId)\r\n          }\r\n          type=\"403\"\r\n        >\r\n          <div className=\"main-chapter\">\r\n            <div className=\"chapter-page\">\r\n              <PageHeader\r\n                className=\"site-page-header\"\r\n                onBack={() => router.push(`/story/${router.query.id}`)}\r\n                title=\"Back to story\"\r\n              />\r\n              <h2>\r\n                {chapter.number}. {chapter.title}\r\n              </h2>\r\n              <div className=\"meta\">\r\n                <Divider orientation=\"left\">\r\n                  <Link href=\"/profile/1\">\r\n                    <a>\r\n                      <Space direction=\"vertical\" align=\"center\">\r\n                        <div className=\"avatar\">\r\n                          <img src={dummy.person} alt={dummy.name} />\r\n                        </div>\r\n                        <h5>{chapter.authorName}</h5>\r\n                      </Space>\r\n                    </a>\r\n                  </Link>\r\n                </Divider>\r\n              </div>\r\n              <section\r\n                className=\"chapter-content\"\r\n                dangerouslySetInnerHTML={{ __html: chapter.body }}\r\n              ></section>\r\n              <div className=\"nav-btns\">\r\n                {chapter.prev ? (\r\n                  <Link\r\n                    href={`/story/${router.query.id}/chapter/${chapter.prev}`}\r\n                  >\r\n                    <a>\r\n                      <Tooltip title=\"Previous Chapter\" placement=\"bottom\">\r\n                        <div className=\"icon custom-icon nav-btn prev-btn\">\r\n                          <ion-icon name=\"chevron-back-circle\"></ion-icon>\r\n                        </div>\r\n                      </Tooltip>\r\n                    </a>\r\n                  </Link>\r\n                ) : (\r\n                  <div></div>\r\n                )}\r\n                {chapter.next && (\r\n                  <Link\r\n                    href={`/story/${router.query.id}/chapter/${chapter.next}`}\r\n                  >\r\n                    <a>\r\n                      <Tooltip title=\"Next Chapter\" placement=\"bottom\">\r\n                        <div className=\"icon custom-icon nav-btn next-btn\">\r\n                          <ion-icon name=\"chevron-forward-circle\"></ion-icon>\r\n                        </div>\r\n                      </Tooltip>\r\n                    </a>\r\n                  </Link>\r\n                )}\r\n              </div>\r\n              <Divider />\r\n              {loadingComments ? (\r\n                <Spin />\r\n              ) : (\r\n                <Comments\r\n                  submitComment={props.submitComment}\r\n                  auth={auth}\r\n                  comments={comments}\r\n                  deleteComment={props.deleteComment}\r\n                  chapid={router.query.chapid}\r\n                  storyId={router.query.id}\r\n                  authorId={chapter.authorId}\r\n                  title={chapter.storyTitle}\r\n                />\r\n              )}\r\n            </div>\r\n            <div className=\"main-chapter-details\">\r\n              <h3>Characters in this chapter</h3>\r\n              <CharacterGrid\r\n                gutter={\"12px\"}\r\n                characters={characters}\r\n                type=\"show\"\r\n                columnsCountBreakPoints={{\r\n                  350: 1,\r\n                  750: 2,\r\n                  900: 2,\r\n                  1200: 2,\r\n                  1600: 2,\r\n                }}\r\n              />\r\n              <Divider />\r\n              <h3>Locations in this chapter</h3>\r\n              <LocationGrid\r\n                columnsCountBreakPoints={{\r\n                  350: 1,\r\n                  750: 2,\r\n                  900: 2,\r\n                  1200: 2,\r\n                  1600: 2,\r\n                }}\r\n                gutter={\"12px\"}\r\n                lg={12}\r\n                md={12}\r\n                sm={12}\r\n                xs={12}\r\n                type=\"story\"\r\n                locations={chapter.locations}\r\n              />\r\n            </div>\r\n            {auth.user && auth.user.uid && (\r\n              <RateStory\r\n                userNote={userNote}\r\n                note={chapter.note}\r\n                storyId={router.query.id}\r\n                rateFunc={props.rateStory}\r\n              />\r\n            )}\r\n          </div>\r\n        </RedirectComp>\r\n      </RedirectComp>\r\n    </LoadingScreen>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n  chapter: state.stories.chapter,\r\n  loading: state.stories.loading,\r\n  comments: state.stories.comments,\r\n  loadingComments: state.stories.loadingComments,\r\n  chapterExists: state.stories.chapterExists,\r\n  message: state.stories.message,\r\n  userNote: state.stories.userNote,\r\n});\r\n\r\nexport default connect(mapStateToProps, {\r\n  getChapter,\r\n  getComments,\r\n  submitComment,\r\n  deleteComment,\r\n  getUserNote,\r\n  rateStory,\r\n})(Chapter);\r\n"]},"metadata":{},"sourceType":"module"}