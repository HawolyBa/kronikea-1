{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Utilisateur\\\\Documents\\\\CODE\\\\kronikea-master\\\\components\\\\forms\\\\CustomEditor.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from \"react\";\nimport { Editor, EditorState, RichUtils, convertToRaw, convertFromRaw } from \"draft-js\";\nconst styleMap = {\n  CODE: {\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\n    fontFamily: '\"Inconsolata\", \"Menlo\", \"Consolas\", monospace',\n    fontSize: 16,\n    padding: 4\n  },\n  BOLD: {\n    color: \"#395296\",\n    fontWeight: \"bold\"\n  },\n  ANYCUSTOMSTYLE: {\n    color: \"#00e400\"\n  }\n};\n\nconst CustomEditor = () => {\n  const myRef = React.useRef();\n  const [state, setState] = React.useState({\n    editorState: EditorState.createWithContent(convertFromRaw(initialData)),\n    showToolbar: false,\n    windowWidth: 0,\n    toolbarMeasures: {\n      w: 0,\n      h: 0\n    },\n    selectionMeasures: {\n      w: 0,\n      h: 0\n    },\n    selectionCoordinates: {\n      x: 0,\n      y: 0\n    },\n    toolbarCoordinates: {\n      x: 0,\n      y: 0\n    },\n    showRawData: false\n  });\n\n  const focus = () => editor.focus();\n\n  const onChange = editorState => setState(_objectSpread(_objectSpread({}, state), {}, {\n    editorState\n  }));\n\n  const onClickEditor = () => {\n    focus();\n    checkSelectedText();\n  };\n\n  const checkSelectedText = () => {\n    if (false) {\n      const text = window.getSelection().toString();\n\n      if (text !== \"\") {\n        // 1-a Define the selection coordinates\n        setSelectionXY();\n      } else {\n        // Hide the toolbar if nothing is selected\n        setState(_objectSpread(_objectSpread({}, state), {}, {\n          showToolbar: false\n        }));\n      }\n    }\n  };\n\n  const setSelectionXY = () => {\n    var r = window.getSelection().getRangeAt(0).getBoundingClientRect();\n    var relative = document.body.parentNode.getBoundingClientRect(); // 2-a Set the selection coordinates in the state\n\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      selectionCoordinates: r,\n      windowWidth: relative.width,\n      selectionMeasures: {\n        w: r.width,\n        h: r.height\n      }\n    }), () => showToolbar());\n  };\n\n  const showToolbar = () => {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      showToolbar: true\n    }), () => measureToolbar());\n  };\n\n  const measureToolbar = () => {\n    // 4-a Define the toolbar width and height, as it is now visible\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      toolbarMeasures: {\n        w: myRef.current.elemWidth,\n        h: myRef.current.elemHeight\n      }\n    }), () => setToolbarXY());\n  };\n\n  const setToolbarXY = () => {\n    let coordinates = {};\n    const {\n      selectionMeasures,\n      selectionCoordinates,\n      toolbarMeasures,\n      windowWidth\n    } = state;\n    const hiddenTop = selectionCoordinates.y < toolbarMeasures.h;\n    const hiddenRight = windowWidth - selectionCoordinates.x < toolbarMeasures.w / 2;\n    const hiddenLeft = selectionCoordinates.x < toolbarMeasures.w / 2;\n    const normalX = selectionCoordinates.x - toolbarMeasures.w / 2 + selectionMeasures.w / 2;\n    const normalY = selectionCoordinates.y - toolbarMeasures.h;\n    const invertedY = selectionCoordinates.y + selectionMeasures.h;\n    const moveXToLeft = windowWidth - toolbarMeasures.w;\n    const moveXToRight = 0;\n    coordinates = {\n      x: normalX,\n      y: normalY\n    };\n\n    if (hiddenTop) {\n      coordinates.y = invertedY;\n    }\n\n    if (hiddenRight) {\n      coordinates.x = moveXToLeft;\n    }\n\n    if (hiddenLeft) {\n      coordinates.x = moveXToRight;\n    }\n\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      toolbarCoordinates: coordinates\n    }));\n  };\n\n  const toggleToolbar = inlineStyle => {\n    onChange(RichUtils.toggleInlineStyle(state.editorState, inlineStyle));\n  };\n\n  const {\n    editorState\n  } = state;\n  React.useEffect(() => {\n    if (false) {\n      window.addEventListener(\"resize\", checkSelectedText);\n    }\n  }, [window]);\n  const toolbarStyle = {\n    display: state.showToolbar ? \"block\" : \"none\",\n    backgroundColor: \"black\",\n    color: \"white\",\n    position: \"absolute\",\n    left: state.toolbarCoordinates.x,\n    top: state.toolbarCoordinates.y,\n    zIndex: 999,\n    padding: 10\n  };\n\n  const handleKeyCommand = command => {\n    const {\n      editorState\n    } = state;\n    const newState = RichUtils.handleKeyCommand(editorState, command);\n\n    if (newState) {\n      onChange(newState);\n      return true;\n    }\n\n    return false;\n  };\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    ref: elem => {\n      elemWidth = elem ? elem.clientWidth : 0;\n      elemHeight = elem ? elem.clientHeight : 0;\n    },\n    style: toolbarStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 7\n    }\n  }, __jsx(ToolBar, {\n    editorState: editorState,\n    onToggle: toggleToolbar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 9\n    }\n  })), __jsx(\"div\", {\n    onClick: onClickEditor,\n    onBlur: checkSelectedText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }\n  }, __jsx(Editor, {\n    customStyleMap: styleMap,\n    editorState: editorState,\n    handleKeyCommand: handleKeyCommand,\n    onChange: onChange,\n    placeholder: \"Tell a story...\",\n    editorKey: \"foobar\",\n    spellCheck: false,\n    ref: element => {\n      editor = element;\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 9\n    }\n  })), __jsx(\"div\", {\n    style: {\n      marginTop: 40\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }\n  }, __jsx(\"button\", {\n    onClick: () => setState(_objectSpread(_objectSpread({}, state), {}, {\n      showRawData: !state.showRawData\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 9\n    }\n  }, !state.showRawData ? \"Show\" : \"Hide\", \" Raw Data\"), __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 9\n    }\n  }), state.showRawData && JSON.stringify(convertToRaw(editorState.getCurrentContent()))));\n};\n\nconst ToolbarButton = props => {\n  const onToggle = e => {\n    e.preventDefault();\n    props.onToggle(props.style);\n  };\n\n  const [buttonStyle] = React.useState({\n    padding: 10\n  });\n  return __jsx(\"span\", {\n    onMouseDown: onToggle,\n    style: buttonStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 5\n    }\n  }, props.label);\n};\n\nconst toolbarItems = [{\n  label: \"Bold\",\n  style: \"BOLD\"\n}, {\n  label: \"Italic\",\n  style: \"ITALIC\"\n}, {\n  label: \"Underline\",\n  style: \"UNDERLINE\"\n}, {\n  label: \"Code\",\n  style: \"CODE\"\n}, {\n  label: \"Surprise\",\n  style: \"ANYCUSTOMSTYLE\"\n}];\n\nconst ToolBar = props => {\n  const currentStyle = props.editorState.getCurrentInlineStyle();\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 5\n    }\n  }, toolbarItems.map(toolbarItem => __jsx(ToolbarButton, {\n    key: toolbarItem.label,\n    active: currentStyle.has(toolbarItem.style),\n    label: toolbarItem.label,\n    onToggle: props.onToggle,\n    style: toolbarItem.style,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 9\n    }\n  })));\n};\n\nconst initialData = {\n  blocks: [{\n    key: \"16d0k\",\n    text: \"You can edit this text.\",\n    type: \"unstyled\",\n    depth: 0,\n    inlineStyleRanges: [{\n      offset: 0,\n      length: 23,\n      style: \"BOLD\"\n    }],\n    entityRanges: [],\n    data: {}\n  }, {\n    key: \"98peq\",\n    text: \"\",\n    type: \"unstyled\",\n    depth: 0,\n    inlineStyleRanges: [],\n    entityRanges: [],\n    data: {}\n  }, {\n    key: \"ecmnc\",\n    text: \"Luke Skywalker has vanished. In his absence, the sinister FIRST ORDER has risen from the ashes of the Empire and will not rest until Skywalker, the last Jedi, has been destroyed.\",\n    type: \"unstyled\",\n    depth: 0,\n    inlineStyleRanges: [{\n      offset: 0,\n      length: 14,\n      style: \"BOLD\"\n    }, {\n      offset: 133,\n      length: 9,\n      style: \"BOLD\"\n    }],\n    entityRanges: [],\n    data: {}\n  }, {\n    key: \"fe2gn\",\n    text: \"\",\n    type: \"unstyled\",\n    depth: 0,\n    inlineStyleRanges: [],\n    entityRanges: [],\n    data: {}\n  }, {\n    key: \"4481k\",\n    text: \"With the support of the REPUBLIC, General Leia Organa leads a brave RESISTANCE. She is desperate to find her brother Luke and gain his help in restoring peace and justice to the galaxy.\",\n    type: \"unstyled\",\n    depth: 0,\n    inlineStyleRanges: [{\n      offset: 34,\n      length: 19,\n      style: \"BOLD\"\n    }, {\n      offset: 117,\n      length: 4,\n      style: \"BOLD\"\n    }, {\n      offset: 68,\n      length: 10,\n      style: \"ANYCUSTOMSTYLE\"\n    }],\n    entityRanges: [],\n    data: {}\n  }],\n  entityMap: {}\n};\nexport default CustomEditor;","map":{"version":3,"sources":["C:/Users/Utilisateur/Documents/CODE/kronikea-master/components/forms/CustomEditor.js"],"names":["React","Editor","EditorState","RichUtils","convertToRaw","convertFromRaw","styleMap","CODE","backgroundColor","fontFamily","fontSize","padding","BOLD","color","fontWeight","ANYCUSTOMSTYLE","CustomEditor","myRef","useRef","state","setState","useState","editorState","createWithContent","initialData","showToolbar","windowWidth","toolbarMeasures","w","h","selectionMeasures","selectionCoordinates","x","y","toolbarCoordinates","showRawData","focus","editor","onChange","onClickEditor","checkSelectedText","text","window","getSelection","toString","setSelectionXY","r","getRangeAt","getBoundingClientRect","relative","document","body","parentNode","width","height","measureToolbar","current","elemWidth","elemHeight","setToolbarXY","coordinates","hiddenTop","hiddenRight","hiddenLeft","normalX","normalY","invertedY","moveXToLeft","moveXToRight","toggleToolbar","inlineStyle","toggleInlineStyle","useEffect","addEventListener","toolbarStyle","display","position","left","top","zIndex","handleKeyCommand","command","newState","elem","clientWidth","clientHeight","element","marginTop","JSON","stringify","getCurrentContent","ToolbarButton","props","onToggle","e","preventDefault","style","buttonStyle","label","toolbarItems","ToolBar","currentStyle","getCurrentInlineStyle","map","toolbarItem","has","blocks","key","type","depth","inlineStyleRanges","offset","length","entityRanges","data","entityMap"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACEC,MADF,EAEEC,WAFF,EAGEC,SAHF,EAIEC,YAJF,EAKEC,cALF,QAMO,UANP;AAQA,MAAMC,QAAQ,GAAG;AACfC,EAAAA,IAAI,EAAE;AACJC,IAAAA,eAAe,EAAE,qBADb;AAEJC,IAAAA,UAAU,EAAE,+CAFR;AAGJC,IAAAA,QAAQ,EAAE,EAHN;AAIJC,IAAAA,OAAO,EAAE;AAJL,GADS;AAOfC,EAAAA,IAAI,EAAE;AACJC,IAAAA,KAAK,EAAE,SADH;AAEJC,IAAAA,UAAU,EAAE;AAFR,GAPS;AAWfC,EAAAA,cAAc,EAAE;AACdF,IAAAA,KAAK,EAAE;AADO;AAXD,CAAjB;;AAgBA,MAAMG,YAAY,GAAG,MAAM;AACzB,QAAMC,KAAK,GAAGjB,KAAK,CAACkB,MAAN,EAAd;AACA,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBpB,KAAK,CAACqB,QAAN,CAAe;AACvCC,IAAAA,WAAW,EAAEpB,WAAW,CAACqB,iBAAZ,CAA8BlB,cAAc,CAACmB,WAAD,CAA5C,CAD0B;AAEvCC,IAAAA,WAAW,EAAE,KAF0B;AAGvCC,IAAAA,WAAW,EAAE,CAH0B;AAIvCC,IAAAA,eAAe,EAAE;AACfC,MAAAA,CAAC,EAAE,CADY;AAEfC,MAAAA,CAAC,EAAE;AAFY,KAJsB;AAQvCC,IAAAA,iBAAiB,EAAE;AACjBF,MAAAA,CAAC,EAAE,CADc;AAEjBC,MAAAA,CAAC,EAAE;AAFc,KARoB;AAYvCE,IAAAA,oBAAoB,EAAE;AACpBC,MAAAA,CAAC,EAAE,CADiB;AAEpBC,MAAAA,CAAC,EAAE;AAFiB,KAZiB;AAgBvCC,IAAAA,kBAAkB,EAAE;AAClBF,MAAAA,CAAC,EAAE,CADe;AAElBC,MAAAA,CAAC,EAAE;AAFe,KAhBmB;AAoBvCE,IAAAA,WAAW,EAAE;AApB0B,GAAf,CAA1B;;AAuBA,QAAMC,KAAK,GAAG,MAAMC,MAAM,CAACD,KAAP,EAApB;;AACA,QAAME,QAAQ,GAAIhB,WAAD,IAAiBF,QAAQ,iCAAMD,KAAN;AAAaG,IAAAA;AAAb,KAA1C;;AAEA,QAAMiB,aAAa,GAAG,MAAM;AAC1BH,IAAAA,KAAK;AACLI,IAAAA,iBAAiB;AAClB,GAHD;;AAKA,QAAMA,iBAAiB,GAAG,MAAM;AAC9B,eAAmC;AACjC,YAAMC,IAAI,GAAGC,MAAM,CAACC,YAAP,GAAsBC,QAAtB,EAAb;;AACA,UAAIH,IAAI,KAAK,EAAb,EAAiB;AACf;AACAI,QAAAA,cAAc;AACf,OAHD,MAGO;AACL;AACAzB,QAAAA,QAAQ,iCACHD,KADG;AAENM,UAAAA,WAAW,EAAE;AAFP,WAAR;AAID;AACF;AACF,GAdD;;AAgBA,QAAMoB,cAAc,GAAG,MAAM;AAC3B,QAAIC,CAAC,GAAGJ,MAAM,CAACC,YAAP,GAAsBI,UAAtB,CAAiC,CAAjC,EAAoCC,qBAApC,EAAR;AACA,QAAIC,QAAQ,GAAGC,QAAQ,CAACC,IAAT,CAAcC,UAAd,CAAyBJ,qBAAzB,EAAf,CAF2B,CAG3B;;AACA5B,IAAAA,QAAQ,iCAEDD,KAFC;AAGJY,MAAAA,oBAAoB,EAAEe,CAHlB;AAIJpB,MAAAA,WAAW,EAAEuB,QAAQ,CAACI,KAJlB;AAKJvB,MAAAA,iBAAiB,EAAE;AACjBF,QAAAA,CAAC,EAAEkB,CAAC,CAACO,KADY;AAEjBxB,QAAAA,CAAC,EAAEiB,CAAC,CAACQ;AAFY;AALf,QAUN,MAAM7B,WAAW,EAVX,CAAR;AAYD,GAhBD;;AAkBA,QAAMA,WAAW,GAAG,MAAM;AACxBL,IAAAA,QAAQ,iCAEDD,KAFC;AAGJM,MAAAA,WAAW,EAAE;AAHT,QAKN,MAAM8B,cAAc,EALd,CAAR;AAOD,GARD;;AAUA,QAAMA,cAAc,GAAG,MAAM;AAC3B;AACAnC,IAAAA,QAAQ,iCAEDD,KAFC;AAGJQ,MAAAA,eAAe,EAAE;AACfC,QAAAA,CAAC,EAAEX,KAAK,CAACuC,OAAN,CAAcC,SADF;AAEf5B,QAAAA,CAAC,EAAEZ,KAAK,CAACuC,OAAN,CAAcE;AAFF;AAHb,QAQN,MAAMC,YAAY,EARZ,CAAR;AAUD,GAZD;;AAcA,QAAMA,YAAY,GAAG,MAAM;AACzB,QAAIC,WAAW,GAAG,EAAlB;AAEA,UAAM;AACJ9B,MAAAA,iBADI;AAEJC,MAAAA,oBAFI;AAGJJ,MAAAA,eAHI;AAIJD,MAAAA;AAJI,QAKFP,KALJ;AAOA,UAAM0C,SAAS,GAAG9B,oBAAoB,CAACE,CAArB,GAAyBN,eAAe,CAACE,CAA3D;AACA,UAAMiC,WAAW,GACfpC,WAAW,GAAGK,oBAAoB,CAACC,CAAnC,GAAuCL,eAAe,CAACC,CAAhB,GAAoB,CAD7D;AAEA,UAAMmC,UAAU,GAAGhC,oBAAoB,CAACC,CAArB,GAAyBL,eAAe,CAACC,CAAhB,GAAoB,CAAhE;AAEA,UAAMoC,OAAO,GACXjC,oBAAoB,CAACC,CAArB,GAAyBL,eAAe,CAACC,CAAhB,GAAoB,CAA7C,GAAiDE,iBAAiB,CAACF,CAAlB,GAAsB,CADzE;AAEA,UAAMqC,OAAO,GAAGlC,oBAAoB,CAACE,CAArB,GAAyBN,eAAe,CAACE,CAAzD;AAEA,UAAMqC,SAAS,GAAGnC,oBAAoB,CAACE,CAArB,GAAyBH,iBAAiB,CAACD,CAA7D;AACA,UAAMsC,WAAW,GAAGzC,WAAW,GAAGC,eAAe,CAACC,CAAlD;AACA,UAAMwC,YAAY,GAAG,CAArB;AAEAR,IAAAA,WAAW,GAAG;AACZ5B,MAAAA,CAAC,EAAEgC,OADS;AAEZ/B,MAAAA,CAAC,EAAEgC;AAFS,KAAd;;AAKA,QAAIJ,SAAJ,EAAe;AACbD,MAAAA,WAAW,CAAC3B,CAAZ,GAAgBiC,SAAhB;AACD;;AAED,QAAIJ,WAAJ,EAAiB;AACfF,MAAAA,WAAW,CAAC5B,CAAZ,GAAgBmC,WAAhB;AACD;;AAED,QAAIJ,UAAJ,EAAgB;AACdH,MAAAA,WAAW,CAAC5B,CAAZ,GAAgBoC,YAAhB;AACD;;AAEDhD,IAAAA,QAAQ,iCACHD,KADG;AAENe,MAAAA,kBAAkB,EAAE0B;AAFd,OAAR;AAID,GA5CD;;AA8CA,QAAMS,aAAa,GAAIC,WAAD,IAAiB;AACrChC,IAAAA,QAAQ,CAACnC,SAAS,CAACoE,iBAAV,CAA4BpD,KAAK,CAACG,WAAlC,EAA+CgD,WAA/C,CAAD,CAAR;AACD,GAFD;;AAIA,QAAM;AAAEhD,IAAAA;AAAF,MAAkBH,KAAxB;AAEAnB,EAAAA,KAAK,CAACwE,SAAN,CAAgB,MAAM;AACpB,eAAmC;AACjC9B,MAAAA,MAAM,CAAC+B,gBAAP,CAAwB,QAAxB,EAAkCjC,iBAAlC;AACD;AACF,GAJD,EAIG,CAACE,MAAD,CAJH;AAMA,QAAMgC,YAAY,GAAG;AACnBC,IAAAA,OAAO,EAAExD,KAAK,CAACM,WAAN,GAAoB,OAApB,GAA8B,MADpB;AAEnBjB,IAAAA,eAAe,EAAE,OAFE;AAGnBK,IAAAA,KAAK,EAAE,OAHY;AAInB+D,IAAAA,QAAQ,EAAE,UAJS;AAKnBC,IAAAA,IAAI,EAAE1D,KAAK,CAACe,kBAAN,CAAyBF,CALZ;AAMnB8C,IAAAA,GAAG,EAAE3D,KAAK,CAACe,kBAAN,CAAyBD,CANX;AAOnB8C,IAAAA,MAAM,EAAE,GAPW;AAQnBpE,IAAAA,OAAO,EAAE;AARU,GAArB;;AAWA,QAAMqE,gBAAgB,GAAIC,OAAD,IAAa;AACpC,UAAM;AAAE3D,MAAAA;AAAF,QAAkBH,KAAxB;AACA,UAAM+D,QAAQ,GAAG/E,SAAS,CAAC6E,gBAAV,CAA2B1D,WAA3B,EAAwC2D,OAAxC,CAAjB;;AACA,QAAIC,QAAJ,EAAc;AACZ5C,MAAAA,QAAQ,CAAC4C,QAAD,CAAR;AACA,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GARD;;AAUA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AACE,IAAA,GAAG,EAAGC,IAAD,IAAU;AACb1B,MAAAA,SAAS,GAAG0B,IAAI,GAAGA,IAAI,CAACC,WAAR,GAAsB,CAAtC;AACA1B,MAAAA,UAAU,GAAGyB,IAAI,GAAGA,IAAI,CAACE,YAAR,GAAuB,CAAxC;AACD,KAJH;AAKE,IAAA,KAAK,EAAEX,YALT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAOE,MAAC,OAAD;AAAS,IAAA,WAAW,EAAEpD,WAAtB;AAAmC,IAAA,QAAQ,EAAE+C,aAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPF,CADF,EAUE;AAAK,IAAA,OAAO,EAAE9B,aAAd;AAA6B,IAAA,MAAM,EAAEC,iBAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,MAAD;AACE,IAAA,cAAc,EAAElC,QADlB;AAEE,IAAA,WAAW,EAAEgB,WAFf;AAGE,IAAA,gBAAgB,EAAE0D,gBAHpB;AAIE,IAAA,QAAQ,EAAE1C,QAJZ;AAKE,IAAA,WAAW,EAAC,iBALd;AAME,IAAA,SAAS,EAAC,QANZ;AAOE,IAAA,UAAU,EAAE,KAPd;AAQE,IAAA,GAAG,EAAGgD,OAAD,IAAa;AAChBjD,MAAAA,MAAM,GAAGiD,OAAT;AACD,KAVH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAVF,EAwBE;AAAK,IAAA,KAAK,EAAE;AAAEC,MAAAA,SAAS,EAAE;AAAb,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AACE,IAAA,OAAO,EAAE,MACPnE,QAAQ,iCAAMD,KAAN;AAAagB,MAAAA,WAAW,EAAE,CAAChB,KAAK,CAACgB;AAAjC,OAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKG,CAAChB,KAAK,CAACgB,WAAP,GAAqB,MAArB,GAA8B,MALjC,cADF,EAQE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARF,EASGhB,KAAK,CAACgB,WAAN,IACCqD,IAAI,CAACC,SAAL,CAAerF,YAAY,CAACkB,WAAW,CAACoE,iBAAZ,EAAD,CAA3B,CAVJ,CAxBF,CADF;AAuCD,CAjND;;AAmNA,MAAMC,aAAa,GAAIC,KAAD,IAAW;AAC/B,QAAMC,QAAQ,GAAIC,CAAD,IAAO;AACtBA,IAAAA,CAAC,CAACC,cAAF;AACAH,IAAAA,KAAK,CAACC,QAAN,CAAeD,KAAK,CAACI,KAArB;AACD,GAHD;;AAKA,QAAM,CAACC,WAAD,IAAgBjG,KAAK,CAACqB,QAAN,CAAe;AAAEV,IAAAA,OAAO,EAAE;AAAX,GAAf,CAAtB;AAEA,SACE;AAAM,IAAA,WAAW,EAAEkF,QAAnB;AAA6B,IAAA,KAAK,EAAEI,WAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGL,KAAK,CAACM,KADT,CADF;AAKD,CAbD;;AAeA,MAAMC,YAAY,GAAG,CACnB;AAAED,EAAAA,KAAK,EAAE,MAAT;AAAiBF,EAAAA,KAAK,EAAE;AAAxB,CADmB,EAEnB;AAAEE,EAAAA,KAAK,EAAE,QAAT;AAAmBF,EAAAA,KAAK,EAAE;AAA1B,CAFmB,EAGnB;AAAEE,EAAAA,KAAK,EAAE,WAAT;AAAsBF,EAAAA,KAAK,EAAE;AAA7B,CAHmB,EAInB;AAAEE,EAAAA,KAAK,EAAE,MAAT;AAAiBF,EAAAA,KAAK,EAAE;AAAxB,CAJmB,EAKnB;AAAEE,EAAAA,KAAK,EAAE,UAAT;AAAqBF,EAAAA,KAAK,EAAE;AAA5B,CALmB,CAArB;;AAQA,MAAMI,OAAO,GAAIR,KAAD,IAAW;AACzB,QAAMS,YAAY,GAAGT,KAAK,CAACtE,WAAN,CAAkBgF,qBAAlB,EAArB;AACA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGH,YAAY,CAACI,GAAb,CAAkBC,WAAD,IAChB,MAAC,aAAD;AACE,IAAA,GAAG,EAAEA,WAAW,CAACN,KADnB;AAEE,IAAA,MAAM,EAAEG,YAAY,CAACI,GAAb,CAAiBD,WAAW,CAACR,KAA7B,CAFV;AAGE,IAAA,KAAK,EAAEQ,WAAW,CAACN,KAHrB;AAIE,IAAA,QAAQ,EAAEN,KAAK,CAACC,QAJlB;AAKE,IAAA,KAAK,EAAEW,WAAW,CAACR,KALrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CADH,CADF;AAaD,CAfD;;AAiBA,MAAMxE,WAAW,GAAG;AAClBkF,EAAAA,MAAM,EAAE,CACN;AACEC,IAAAA,GAAG,EAAE,OADP;AAEElE,IAAAA,IAAI,EAAE,yBAFR;AAGEmE,IAAAA,IAAI,EAAE,UAHR;AAIEC,IAAAA,KAAK,EAAE,CAJT;AAKEC,IAAAA,iBAAiB,EAAE,CAAC;AAAEC,MAAAA,MAAM,EAAE,CAAV;AAAaC,MAAAA,MAAM,EAAE,EAArB;AAAyBhB,MAAAA,KAAK,EAAE;AAAhC,KAAD,CALrB;AAMEiB,IAAAA,YAAY,EAAE,EANhB;AAOEC,IAAAA,IAAI,EAAE;AAPR,GADM,EAUN;AACEP,IAAAA,GAAG,EAAE,OADP;AAEElE,IAAAA,IAAI,EAAE,EAFR;AAGEmE,IAAAA,IAAI,EAAE,UAHR;AAIEC,IAAAA,KAAK,EAAE,CAJT;AAKEC,IAAAA,iBAAiB,EAAE,EALrB;AAMEG,IAAAA,YAAY,EAAE,EANhB;AAOEC,IAAAA,IAAI,EAAE;AAPR,GAVM,EAmBN;AACEP,IAAAA,GAAG,EAAE,OADP;AAEElE,IAAAA,IAAI,EACF,oLAHJ;AAIEmE,IAAAA,IAAI,EAAE,UAJR;AAKEC,IAAAA,KAAK,EAAE,CALT;AAMEC,IAAAA,iBAAiB,EAAE,CACjB;AAAEC,MAAAA,MAAM,EAAE,CAAV;AAAaC,MAAAA,MAAM,EAAE,EAArB;AAAyBhB,MAAAA,KAAK,EAAE;AAAhC,KADiB,EAEjB;AAAEe,MAAAA,MAAM,EAAE,GAAV;AAAeC,MAAAA,MAAM,EAAE,CAAvB;AAA0BhB,MAAAA,KAAK,EAAE;AAAjC,KAFiB,CANrB;AAUEiB,IAAAA,YAAY,EAAE,EAVhB;AAWEC,IAAAA,IAAI,EAAE;AAXR,GAnBM,EAgCN;AACEP,IAAAA,GAAG,EAAE,OADP;AAEElE,IAAAA,IAAI,EAAE,EAFR;AAGEmE,IAAAA,IAAI,EAAE,UAHR;AAIEC,IAAAA,KAAK,EAAE,CAJT;AAKEC,IAAAA,iBAAiB,EAAE,EALrB;AAMEG,IAAAA,YAAY,EAAE,EANhB;AAOEC,IAAAA,IAAI,EAAE;AAPR,GAhCM,EAyCN;AACEP,IAAAA,GAAG,EAAE,OADP;AAEElE,IAAAA,IAAI,EACF,2LAHJ;AAIEmE,IAAAA,IAAI,EAAE,UAJR;AAKEC,IAAAA,KAAK,EAAE,CALT;AAMEC,IAAAA,iBAAiB,EAAE,CACjB;AAAEC,MAAAA,MAAM,EAAE,EAAV;AAAcC,MAAAA,MAAM,EAAE,EAAtB;AAA0BhB,MAAAA,KAAK,EAAE;AAAjC,KADiB,EAEjB;AAAEe,MAAAA,MAAM,EAAE,GAAV;AAAeC,MAAAA,MAAM,EAAE,CAAvB;AAA0BhB,MAAAA,KAAK,EAAE;AAAjC,KAFiB,EAGjB;AAAEe,MAAAA,MAAM,EAAE,EAAV;AAAcC,MAAAA,MAAM,EAAE,EAAtB;AAA0BhB,MAAAA,KAAK,EAAE;AAAjC,KAHiB,CANrB;AAWEiB,IAAAA,YAAY,EAAE,EAXhB;AAYEC,IAAAA,IAAI,EAAE;AAZR,GAzCM,CADU;AAyDlBC,EAAAA,SAAS,EAAE;AAzDO,CAApB;AA4DA,eAAenG,YAAf","sourcesContent":["import React from \"react\";\r\nimport {\r\n  Editor,\r\n  EditorState,\r\n  RichUtils,\r\n  convertToRaw,\r\n  convertFromRaw,\r\n} from \"draft-js\";\r\n\r\nconst styleMap = {\r\n  CODE: {\r\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\r\n    fontFamily: '\"Inconsolata\", \"Menlo\", \"Consolas\", monospace',\r\n    fontSize: 16,\r\n    padding: 4,\r\n  },\r\n  BOLD: {\r\n    color: \"#395296\",\r\n    fontWeight: \"bold\",\r\n  },\r\n  ANYCUSTOMSTYLE: {\r\n    color: \"#00e400\",\r\n  },\r\n};\r\n\r\nconst CustomEditor = () => {\r\n  const myRef = React.useRef();\r\n  const [state, setState] = React.useState({\r\n    editorState: EditorState.createWithContent(convertFromRaw(initialData)),\r\n    showToolbar: false,\r\n    windowWidth: 0,\r\n    toolbarMeasures: {\r\n      w: 0,\r\n      h: 0,\r\n    },\r\n    selectionMeasures: {\r\n      w: 0,\r\n      h: 0,\r\n    },\r\n    selectionCoordinates: {\r\n      x: 0,\r\n      y: 0,\r\n    },\r\n    toolbarCoordinates: {\r\n      x: 0,\r\n      y: 0,\r\n    },\r\n    showRawData: false,\r\n  });\r\n\r\n  const focus = () => editor.focus();\r\n  const onChange = (editorState) => setState({ ...state, editorState });\r\n\r\n  const onClickEditor = () => {\r\n    focus();\r\n    checkSelectedText();\r\n  };\r\n\r\n  const checkSelectedText = () => {\r\n    if (typeof window !== \"undefined\") {\r\n      const text = window.getSelection().toString();\r\n      if (text !== \"\") {\r\n        // 1-a Define the selection coordinates\r\n        setSelectionXY();\r\n      } else {\r\n        // Hide the toolbar if nothing is selected\r\n        setState({\r\n          ...state,\r\n          showToolbar: false,\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const setSelectionXY = () => {\r\n    var r = window.getSelection().getRangeAt(0).getBoundingClientRect();\r\n    var relative = document.body.parentNode.getBoundingClientRect();\r\n    // 2-a Set the selection coordinates in the state\r\n    setState(\r\n      {\r\n        ...state,\r\n        selectionCoordinates: r,\r\n        windowWidth: relative.width,\r\n        selectionMeasures: {\r\n          w: r.width,\r\n          h: r.height,\r\n        },\r\n      },\r\n      () => showToolbar()\r\n    );\r\n  };\r\n\r\n  const showToolbar = () => {\r\n    setState(\r\n      {\r\n        ...state,\r\n        showToolbar: true,\r\n      },\r\n      () => measureToolbar()\r\n    );\r\n  };\r\n\r\n  const measureToolbar = () => {\r\n    // 4-a Define the toolbar width and height, as it is now visible\r\n    setState(\r\n      {\r\n        ...state,\r\n        toolbarMeasures: {\r\n          w: myRef.current.elemWidth,\r\n          h: myRef.current.elemHeight,\r\n        },\r\n      },\r\n      () => setToolbarXY()\r\n    );\r\n  };\r\n\r\n  const setToolbarXY = () => {\r\n    let coordinates = {};\r\n\r\n    const {\r\n      selectionMeasures,\r\n      selectionCoordinates,\r\n      toolbarMeasures,\r\n      windowWidth,\r\n    } = state;\r\n\r\n    const hiddenTop = selectionCoordinates.y < toolbarMeasures.h;\r\n    const hiddenRight =\r\n      windowWidth - selectionCoordinates.x < toolbarMeasures.w / 2;\r\n    const hiddenLeft = selectionCoordinates.x < toolbarMeasures.w / 2;\r\n\r\n    const normalX =\r\n      selectionCoordinates.x - toolbarMeasures.w / 2 + selectionMeasures.w / 2;\r\n    const normalY = selectionCoordinates.y - toolbarMeasures.h;\r\n\r\n    const invertedY = selectionCoordinates.y + selectionMeasures.h;\r\n    const moveXToLeft = windowWidth - toolbarMeasures.w;\r\n    const moveXToRight = 0;\r\n\r\n    coordinates = {\r\n      x: normalX,\r\n      y: normalY,\r\n    };\r\n\r\n    if (hiddenTop) {\r\n      coordinates.y = invertedY;\r\n    }\r\n\r\n    if (hiddenRight) {\r\n      coordinates.x = moveXToLeft;\r\n    }\r\n\r\n    if (hiddenLeft) {\r\n      coordinates.x = moveXToRight;\r\n    }\r\n\r\n    setState({\r\n      ...state,\r\n      toolbarCoordinates: coordinates,\r\n    });\r\n  };\r\n\r\n  const toggleToolbar = (inlineStyle) => {\r\n    onChange(RichUtils.toggleInlineStyle(state.editorState, inlineStyle));\r\n  };\r\n\r\n  const { editorState } = state;\r\n\r\n  React.useEffect(() => {\r\n    if (typeof window !== \"undefined\") {\r\n      window.addEventListener(\"resize\", checkSelectedText);\r\n    }\r\n  }, [window]);\r\n\r\n  const toolbarStyle = {\r\n    display: state.showToolbar ? \"block\" : \"none\",\r\n    backgroundColor: \"black\",\r\n    color: \"white\",\r\n    position: \"absolute\",\r\n    left: state.toolbarCoordinates.x,\r\n    top: state.toolbarCoordinates.y,\r\n    zIndex: 999,\r\n    padding: 10,\r\n  };\r\n\r\n  const handleKeyCommand = (command) => {\r\n    const { editorState } = state;\r\n    const newState = RichUtils.handleKeyCommand(editorState, command);\r\n    if (newState) {\r\n      onChange(newState);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div\r\n        ref={(elem) => {\r\n          elemWidth = elem ? elem.clientWidth : 0;\r\n          elemHeight = elem ? elem.clientHeight : 0;\r\n        }}\r\n        style={toolbarStyle}\r\n      >\r\n        <ToolBar editorState={editorState} onToggle={toggleToolbar} />\r\n      </div>\r\n      <div onClick={onClickEditor} onBlur={checkSelectedText}>\r\n        <Editor\r\n          customStyleMap={styleMap}\r\n          editorState={editorState}\r\n          handleKeyCommand={handleKeyCommand}\r\n          onChange={onChange}\r\n          placeholder=\"Tell a story...\"\r\n          editorKey=\"foobar\"\r\n          spellCheck={false}\r\n          ref={(element) => {\r\n            editor = element;\r\n          }}\r\n        />\r\n      </div>\r\n      <div style={{ marginTop: 40 }}>\r\n        <button\r\n          onClick={() =>\r\n            setState({ ...state, showRawData: !state.showRawData })\r\n          }\r\n        >\r\n          {!state.showRawData ? \"Show\" : \"Hide\"} Raw Data\r\n        </button>\r\n        <br />\r\n        {state.showRawData &&\r\n          JSON.stringify(convertToRaw(editorState.getCurrentContent()))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ToolbarButton = (props) => {\r\n  const onToggle = (e) => {\r\n    e.preventDefault();\r\n    props.onToggle(props.style);\r\n  };\r\n\r\n  const [buttonStyle] = React.useState({ padding: 10 });\r\n\r\n  return (\r\n    <span onMouseDown={onToggle} style={buttonStyle}>\r\n      {props.label}\r\n    </span>\r\n  );\r\n};\r\n\r\nconst toolbarItems = [\r\n  { label: \"Bold\", style: \"BOLD\" },\r\n  { label: \"Italic\", style: \"ITALIC\" },\r\n  { label: \"Underline\", style: \"UNDERLINE\" },\r\n  { label: \"Code\", style: \"CODE\" },\r\n  { label: \"Surprise\", style: \"ANYCUSTOMSTYLE\" },\r\n];\r\n\r\nconst ToolBar = (props) => {\r\n  const currentStyle = props.editorState.getCurrentInlineStyle();\r\n  return (\r\n    <div>\r\n      {toolbarItems.map((toolbarItem) => (\r\n        <ToolbarButton\r\n          key={toolbarItem.label}\r\n          active={currentStyle.has(toolbarItem.style)}\r\n          label={toolbarItem.label}\r\n          onToggle={props.onToggle}\r\n          style={toolbarItem.style}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst initialData = {\r\n  blocks: [\r\n    {\r\n      key: \"16d0k\",\r\n      text: \"You can edit this text.\",\r\n      type: \"unstyled\",\r\n      depth: 0,\r\n      inlineStyleRanges: [{ offset: 0, length: 23, style: \"BOLD\" }],\r\n      entityRanges: [],\r\n      data: {},\r\n    },\r\n    {\r\n      key: \"98peq\",\r\n      text: \"\",\r\n      type: \"unstyled\",\r\n      depth: 0,\r\n      inlineStyleRanges: [],\r\n      entityRanges: [],\r\n      data: {},\r\n    },\r\n    {\r\n      key: \"ecmnc\",\r\n      text:\r\n        \"Luke Skywalker has vanished. In his absence, the sinister FIRST ORDER has risen from the ashes of the Empire and will not rest until Skywalker, the last Jedi, has been destroyed.\",\r\n      type: \"unstyled\",\r\n      depth: 0,\r\n      inlineStyleRanges: [\r\n        { offset: 0, length: 14, style: \"BOLD\" },\r\n        { offset: 133, length: 9, style: \"BOLD\" },\r\n      ],\r\n      entityRanges: [],\r\n      data: {},\r\n    },\r\n    {\r\n      key: \"fe2gn\",\r\n      text: \"\",\r\n      type: \"unstyled\",\r\n      depth: 0,\r\n      inlineStyleRanges: [],\r\n      entityRanges: [],\r\n      data: {},\r\n    },\r\n    {\r\n      key: \"4481k\",\r\n      text:\r\n        \"With the support of the REPUBLIC, General Leia Organa leads a brave RESISTANCE. She is desperate to find her brother Luke and gain his help in restoring peace and justice to the galaxy.\",\r\n      type: \"unstyled\",\r\n      depth: 0,\r\n      inlineStyleRanges: [\r\n        { offset: 34, length: 19, style: \"BOLD\" },\r\n        { offset: 117, length: 4, style: \"BOLD\" },\r\n        { offset: 68, length: 10, style: \"ANYCUSTOMSTYLE\" },\r\n      ],\r\n      entityRanges: [],\r\n      data: {},\r\n    },\r\n  ],\r\n  entityMap: {},\r\n};\r\n\r\nexport default CustomEditor;\r\n"]},"metadata":{},"sourceType":"module"}