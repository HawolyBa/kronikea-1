{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Utilisateur\\\\Documents\\\\CODE\\\\kronikea-master\\\\components\\\\forms\\\\CustomEditor.js\",\n    _this4 = this;\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { Component } from \"react\";\nimport { Editor, EditorState, RichUtils, convertToRaw, convertFromRaw, convertToHTML } from \"draft-js\"; //import { convertToHTML } from \"draft-convert\";\n\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";\n\nvar App = /*#__PURE__*/function (_Component) {\n  _inherits(App, _Component);\n\n  var _super = _createSuper(App);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickEditor\", function () {\n      _this.focus();\n\n      _this.checkSelectedText();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkSelectedText\", function () {\n      if (true) {\n        var text = window.getSelection().toString();\n\n        if (text !== \"\") {\n          // 1-a Define the selection coordinates\n          _this.setSelectionXY();\n        } else {\n          // Hide the toolbar if nothing is selected\n          _this.setState({\n            showToolbar: false\n          });\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSelectionXY\", function () {\n      var r = window.getSelection().getRangeAt(0).getBoundingClientRect();\n      var relative = document.body.parentNode.getBoundingClientRect(); // 2-a Set the selection coordinates in the state\n\n      _this.setState({\n        selectionCoordinates: r,\n        windowWidth: relative.width,\n        selectionMeasures: {\n          w: r.width,\n          h: r.height\n        }\n      }, function () {\n        return _this.showToolbar();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showToolbar\", function () {\n      _this.setState({\n        showToolbar: true\n      }, function () {\n        return _this.measureToolbar();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"measureToolbar\", function () {\n      // 4-a Define the toolbar width and height, as it is now visible\n      _this.setState({\n        toolbarMeasures: {\n          w: _this.elemWidth,\n          h: _this.elemHeight\n        }\n      }, function () {\n        return _this.setToolbarXY();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setToolbarXY\", function () {\n      var coordinates = {};\n      var _this$state = _this.state,\n          selectionMeasures = _this$state.selectionMeasures,\n          selectionCoordinates = _this$state.selectionCoordinates,\n          toolbarMeasures = _this$state.toolbarMeasures,\n          windowWidth = _this$state.windowWidth;\n      var hiddenTop = selectionCoordinates.y < toolbarMeasures.h;\n      var hiddenRight = windowWidth - selectionCoordinates.x < toolbarMeasures.w / 2;\n      var hiddenLeft = selectionCoordinates.x < toolbarMeasures.w / 2;\n      var normalX = selectionCoordinates.x - toolbarMeasures.w / 2 + selectionMeasures.w / 2;\n      var normalY = selectionCoordinates.y - toolbarMeasures.h;\n      var invertedY = selectionCoordinates.y + selectionMeasures.h;\n      var moveXToLeft = windowWidth - toolbarMeasures.w;\n      var moveXToRight = 0;\n      coordinates = {\n        x: normalX,\n        y: normalY\n      };\n\n      if (hiddenTop) {\n        coordinates.y = invertedY;\n      }\n\n      if (hiddenRight) {\n        coordinates.x = moveXToLeft;\n      }\n\n      if (hiddenLeft) {\n        coordinates.x = moveXToRight;\n      }\n\n      _this.setState({\n        toolbarCoordinates: coordinates\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleKeyCommand\", function (command) {\n      var editorState = _this.state.editorState;\n      var newState = RichUtils.handleKeyCommand(editorState, command);\n\n      if (newState) {\n        _this.onChange(newState);\n\n        return true;\n      }\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleToolbar\", function (inlineStyle) {\n      _this.onChange(RichUtils.toggleInlineStyle(_this.state.editorState, inlineStyle));\n    });\n\n    _this.state = {\n      editorState: EditorState.createWithContent(convertFromRaw(initialData)),\n      showToolbar: false,\n      windowWidth: 0,\n      toolbarMeasures: {\n        w: 0,\n        h: 0\n      },\n      selectionMeasures: {\n        w: 0,\n        h: 0\n      },\n      selectionCoordinates: {\n        x: 0,\n        y: 0\n      },\n      toolbarCoordinates: {\n        x: 0,\n        y: 0\n      },\n      showRawData: false\n    };\n\n    _this.focus = function () {\n      return _this.editor.focus();\n    };\n\n    _this.onChange = function (editorState) {\n      _this.setState({\n        editorState: editorState\n      });\n\n      _this.props.form.setFieldsValue({\n        body: convertToHTML(editorState.getCurrentContent())\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var editorState = this.state.editorState; // const blocks = convertToRaw(editorState.getCurrentContent()).blocks;\n      // console.log(\n      //   blocks\n      //     .map((block) => (!block.text.trim() && \"\\n\") || block.text)\n      //     .join(\"\\n\")\n      // );\n      // Make sure we're not on the ssr\n\n      if (true) {\n        // Let's stick the toolbar to the selection\n        // when the window is resized\n        window.addEventListener(\"resize\", this.checkSelectedText);\n      }\n\n      var toolbarStyle = {\n        display: this.state.showToolbar ? \"block\" : \"none\",\n        backgroundColor: \"black\",\n        color: \"white\",\n        position: \"absolute\",\n        left: this.state.toolbarCoordinates.x,\n        top: this.state.toolbarCoordinates.y,\n        zIndex: 999,\n        padding: 10\n      };\n      return __jsx(\"div\", {\n        className: \"custom-editor\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 7\n        }\n      }, __jsx(\"div\", {\n        ref: function ref(elem) {\n          _this2.elemWidth = elem ? elem.clientWidth : 0;\n          _this2.elemHeight = elem ? elem.clientHeight : 0;\n        },\n        style: toolbarStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 9\n        }\n      }, __jsx(ToolBar, {\n        editorState: editorState,\n        onToggle: this.toggleToolbar,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }\n      })), __jsx(\"div\", {\n        onClick: this.onClickEditor,\n        onBlur: this.checkSelectedText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 9\n        }\n      }, __jsx(Editor // customStyleMap={styleMap}\n      , {\n        editorState: editorState,\n        handleKeyCommand: this.handleKeyCommand,\n        onChange: this.onChange,\n        placeholder: \"Tell a story...\",\n        editorKey: \"foobar\",\n        spellCheck: false,\n        ref: function ref(element) {\n          _this2.editor = element;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }\n      })));\n    }\n  }]);\n\n  return App;\n}(Component); // Custom overrides for each style\n\n\nexport { App as default };\nvar styleMap = {\n  CODE: {\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\n    fontFamily: '\"Inconsolata\", \"Menlo\", \"Consolas\", monospace',\n    fontSize: 16,\n    padding: 4\n  },\n  BOLD: {\n    color: \"#395296\",\n    fontWeight: \"bold\"\n  },\n  ANYCUSTOMSTYLE: {\n    color: \"#00e400\"\n  }\n};\n\nvar ToolbarButton = /*#__PURE__*/function (_Component2) {\n  _inherits(ToolbarButton, _Component2);\n\n  var _super2 = _createSuper(ToolbarButton);\n\n  function ToolbarButton() {\n    var _this3;\n\n    _classCallCheck(this, ToolbarButton);\n\n    _this3 = _super2.call(this);\n\n    _this3.onToggle = function (e) {\n      e.preventDefault();\n\n      _this3.props.onToggle(_this3.props.style);\n    };\n\n    return _this3;\n  }\n\n  _createClass(ToolbarButton, [{\n    key: \"render\",\n    value: function render() {\n      var buttonStyle = {\n        padding: 10\n      };\n      return __jsx(\"span\", {\n        onMouseDown: this.onToggle,\n        style: buttonStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 7\n        }\n      }, this.props.label);\n    }\n  }]);\n\n  return ToolbarButton;\n}(Component);\n\nvar toolbarItems = [{\n  label: \"Bold\",\n  style: \"BOLD\"\n}, {\n  label: \"Italic\",\n  style: \"ITALIC\"\n}, {\n  label: \"Underline\",\n  style: \"UNDERLINE\"\n}, {\n  label: \"Code\",\n  style: \"CODE\"\n}, {\n  label: \"Surprise\",\n  style: \"ANYCUSTOMSTYLE\"\n}];\n\nvar ToolBar = function ToolBar(props) {\n  var currentStyle = props.editorState.getCurrentInlineStyle();\n  return __jsx(\"div\", {\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 5\n    }\n  }, toolbarItems.map(function (toolbarItem) {\n    return __jsx(ToolbarButton, {\n      key: toolbarItem.label,\n      active: currentStyle.has(toolbarItem.style),\n      label: toolbarItem.label,\n      onToggle: props.onToggle,\n      style: toolbarItem.style,\n      __self: _this4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }\n    });\n  }));\n};\n\n_c = ToolBar;\nvar initialData = {\n  blocks: [//   {\n    //     key: \"16d0k\",\n    //     text: \"You can edit this text.\",\n    //     type: \"unstyled\",\n    //     depth: 0,\n    //     inlineStyleRanges: [{ offset: 0, length: 23, style: \"BOLD\" }],\n    //     entityRanges: [],\n    //     data: {},\n    //   },\n    //   {\n    //     key: \"98peq\",\n    //     text: \"\",\n    //     type: \"unstyled\",\n    //     depth: 0,\n    //     inlineStyleRanges: [],\n    //     entityRanges: [],\n    //     data: {},\n    //   },\n    //   {\n    //     key: \"ecmnc\",\n    //     text:\n    //       \"Luke Skywalker has vanished. In his absence, the sinister FIRST ORDER has risen from the ashes of the Empire and will not rest until Skywalker, the last Jedi, has been destroyed.\",\n    //     type: \"unstyled\",\n    //     depth: 0,\n    //     inlineStyleRanges: [\n    //       { offset: 0, length: 14, style: \"BOLD\" },\n    //       { offset: 133, length: 9, style: \"BOLD\" },\n    //     ],\n    //     entityRanges: [],\n    //     data: {},\n    //   },\n    //   {\n    //     key: \"fe2gn\",\n    //     text: \"\",\n    //     type: \"unstyled\",\n    //     depth: 0,\n    //     inlineStyleRanges: [],\n    //     entityRanges: [],\n    //     data: {},\n    //   },\n    //   {\n    //     key: \"4481k\",\n    //     text:\n    //       \"With the support of the REPUBLIC, General Leia Organa leads a brave RESISTANCE. She is desperate to find her brother Luke and gain his help in restoring peace and justice to the galaxy.\",\n    //     type: \"unstyled\",\n    //     depth: 0,\n    //     inlineStyleRanges: [\n    //       { offset: 34, length: 19, style: \"BOLD\" },\n    //       { offset: 117, length: 4, style: \"BOLD\" },\n    //       { offset: 68, length: 10, style: \"ANYCUSTOMSTYLE\" },\n    //     ],\n    //     entityRanges: [],\n    //     data: {},\n    //   },\n  ],\n  entityMap: {}\n};\n\nvar _c;\n\n$RefreshReg$(_c, \"ToolBar\");","map":{"version":3,"sources":["C:/Users/Utilisateur/Documents/CODE/kronikea-master/components/forms/CustomEditor.js"],"names":["Component","Editor","EditorState","RichUtils","convertToRaw","convertFromRaw","convertToHTML","App","props","focus","checkSelectedText","text","window","getSelection","toString","setSelectionXY","setState","showToolbar","r","getRangeAt","getBoundingClientRect","relative","document","body","parentNode","selectionCoordinates","windowWidth","width","selectionMeasures","w","h","height","measureToolbar","toolbarMeasures","elemWidth","elemHeight","setToolbarXY","coordinates","state","hiddenTop","y","hiddenRight","x","hiddenLeft","normalX","normalY","invertedY","moveXToLeft","moveXToRight","toolbarCoordinates","command","editorState","newState","handleKeyCommand","onChange","inlineStyle","toggleInlineStyle","createWithContent","initialData","showRawData","editor","form","setFieldsValue","getCurrentContent","addEventListener","toolbarStyle","display","backgroundColor","color","position","left","top","zIndex","padding","elem","clientWidth","clientHeight","toggleToolbar","onClickEditor","element","styleMap","CODE","fontFamily","fontSize","BOLD","fontWeight","ANYCUSTOMSTYLE","ToolbarButton","onToggle","e","preventDefault","style","buttonStyle","label","toolbarItems","ToolBar","currentStyle","getCurrentInlineStyle","map","toolbarItem","has","blocks","entityMap"],"mappings":"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","sourcesContent":["import { Component } from \"react\";\r\nimport {\r\n  Editor,\r\n  EditorState,\r\n  RichUtils,\r\n  convertToRaw,\r\n  convertFromRaw,\r\n  convertToHTML,\r\n} from \"draft-js\";\r\n//import { convertToHTML } from \"draft-convert\";\r\n\r\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";\r\n\r\nexport default class App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      editorState: EditorState.createWithContent(convertFromRaw(initialData)),\r\n      showToolbar: false,\r\n      windowWidth: 0,\r\n      toolbarMeasures: {\r\n        w: 0,\r\n        h: 0,\r\n      },\r\n      selectionMeasures: {\r\n        w: 0,\r\n        h: 0,\r\n      },\r\n      selectionCoordinates: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      toolbarCoordinates: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      showRawData: false,\r\n    };\r\n\r\n    this.focus = () => this.editor.focus();\r\n    this.onChange = (editorState) => {\r\n      this.setState({ editorState });\r\n      this.props.form.setFieldsValue({\r\n        body: convertToHTML(editorState.getCurrentContent()),\r\n      });\r\n    };\r\n  }\r\n\r\n  onClickEditor = () => {\r\n    this.focus();\r\n    this.checkSelectedText();\r\n  };\r\n\r\n  // 1- Check if some text is selected\r\n  checkSelectedText = () => {\r\n    if (typeof window !== \"undefined\") {\r\n      const text = window.getSelection().toString();\r\n      if (text !== \"\") {\r\n        // 1-a Define the selection coordinates\r\n        this.setSelectionXY();\r\n      } else {\r\n        // Hide the toolbar if nothing is selected\r\n        this.setState({\r\n          showToolbar: false,\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  // 2- Identify the selection coordinates\r\n  setSelectionXY = () => {\r\n    var r = window.getSelection().getRangeAt(0).getBoundingClientRect();\r\n    var relative = document.body.parentNode.getBoundingClientRect();\r\n    // 2-a Set the selection coordinates in the state\r\n    this.setState(\r\n      {\r\n        selectionCoordinates: r,\r\n        windowWidth: relative.width,\r\n        selectionMeasures: {\r\n          w: r.width,\r\n          h: r.height,\r\n        },\r\n      },\r\n      () => this.showToolbar()\r\n    );\r\n  };\r\n\r\n  // 3- Show the toolbar\r\n  showToolbar = () => {\r\n    this.setState(\r\n      {\r\n        showToolbar: true,\r\n      },\r\n      () => this.measureToolbar()\r\n    );\r\n  };\r\n\r\n  // 4- The toolbar was hidden until now\r\n  measureToolbar = () => {\r\n    // 4-a Define the toolbar width and height, as it is now visible\r\n    this.setState(\r\n      {\r\n        toolbarMeasures: {\r\n          w: this.elemWidth,\r\n          h: this.elemHeight,\r\n        },\r\n      },\r\n      () => this.setToolbarXY()\r\n    );\r\n  };\r\n\r\n  // 5- Now that we have all measures, define toolbar coordinates\r\n  setToolbarXY = () => {\r\n    let coordinates = {};\r\n\r\n    const {\r\n      selectionMeasures,\r\n      selectionCoordinates,\r\n      toolbarMeasures,\r\n      windowWidth,\r\n    } = this.state;\r\n\r\n    const hiddenTop = selectionCoordinates.y < toolbarMeasures.h;\r\n    const hiddenRight =\r\n      windowWidth - selectionCoordinates.x < toolbarMeasures.w / 2;\r\n    const hiddenLeft = selectionCoordinates.x < toolbarMeasures.w / 2;\r\n\r\n    const normalX =\r\n      selectionCoordinates.x - toolbarMeasures.w / 2 + selectionMeasures.w / 2;\r\n    const normalY = selectionCoordinates.y - toolbarMeasures.h;\r\n\r\n    const invertedY = selectionCoordinates.y + selectionMeasures.h;\r\n    const moveXToLeft = windowWidth - toolbarMeasures.w;\r\n    const moveXToRight = 0;\r\n\r\n    coordinates = {\r\n      x: normalX,\r\n      y: normalY,\r\n    };\r\n\r\n    if (hiddenTop) {\r\n      coordinates.y = invertedY;\r\n    }\r\n\r\n    if (hiddenRight) {\r\n      coordinates.x = moveXToLeft;\r\n    }\r\n\r\n    if (hiddenLeft) {\r\n      coordinates.x = moveXToRight;\r\n    }\r\n\r\n    this.setState({\r\n      toolbarCoordinates: coordinates,\r\n    });\r\n  };\r\n\r\n  handleKeyCommand = (command) => {\r\n    const { editorState } = this.state;\r\n    const newState = RichUtils.handleKeyCommand(editorState, command);\r\n    if (newState) {\r\n      this.onChange(newState);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  toggleToolbar = (inlineStyle) => {\r\n    this.onChange(\r\n      RichUtils.toggleInlineStyle(this.state.editorState, inlineStyle)\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { editorState } = this.state;\r\n    // const blocks = convertToRaw(editorState.getCurrentContent()).blocks;\r\n    // console.log(\r\n    //   blocks\r\n    //     .map((block) => (!block.text.trim() && \"\\n\") || block.text)\r\n    //     .join(\"\\n\")\r\n    // );\r\n    // Make sure we're not on the ssr\r\n    if (typeof window !== \"undefined\") {\r\n      // Let's stick the toolbar to the selection\r\n      // when the window is resized\r\n      window.addEventListener(\"resize\", this.checkSelectedText);\r\n    }\r\n\r\n    const toolbarStyle = {\r\n      display: this.state.showToolbar ? \"block\" : \"none\",\r\n      backgroundColor: \"black\",\r\n      color: \"white\",\r\n      position: \"absolute\",\r\n      left: this.state.toolbarCoordinates.x,\r\n      top: this.state.toolbarCoordinates.y,\r\n      zIndex: 999,\r\n      padding: 10,\r\n    };\r\n    return (\r\n      <div className=\"custom-editor\">\r\n        <div\r\n          ref={(elem) => {\r\n            this.elemWidth = elem ? elem.clientWidth : 0;\r\n            this.elemHeight = elem ? elem.clientHeight : 0;\r\n          }}\r\n          style={toolbarStyle}\r\n        >\r\n          <ToolBar editorState={editorState} onToggle={this.toggleToolbar} />\r\n        </div>\r\n        <div onClick={this.onClickEditor} onBlur={this.checkSelectedText}>\r\n          <Editor\r\n            // customStyleMap={styleMap}\r\n            editorState={editorState}\r\n            handleKeyCommand={this.handleKeyCommand}\r\n            onChange={this.onChange}\r\n            placeholder=\"Tell a story...\"\r\n            editorKey=\"foobar\"\r\n            spellCheck={false}\r\n            ref={(element) => {\r\n              this.editor = element;\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n// Custom overrides for each style\r\nconst styleMap = {\r\n  CODE: {\r\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\r\n    fontFamily: '\"Inconsolata\", \"Menlo\", \"Consolas\", monospace',\r\n    fontSize: 16,\r\n    padding: 4,\r\n  },\r\n  BOLD: {\r\n    color: \"#395296\",\r\n    fontWeight: \"bold\",\r\n  },\r\n  ANYCUSTOMSTYLE: {\r\n    color: \"#00e400\",\r\n  },\r\n};\r\n\r\nclass ToolbarButton extends Component {\r\n  constructor() {\r\n    super();\r\n    this.onToggle = (e) => {\r\n      e.preventDefault();\r\n      this.props.onToggle(this.props.style);\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const buttonStyle = {\r\n      padding: 10,\r\n    };\r\n    return (\r\n      <span onMouseDown={this.onToggle} style={buttonStyle}>\r\n        {this.props.label}\r\n      </span>\r\n    );\r\n  }\r\n}\r\n\r\nvar toolbarItems = [\r\n  { label: \"Bold\", style: \"BOLD\" },\r\n  { label: \"Italic\", style: \"ITALIC\" },\r\n  { label: \"Underline\", style: \"UNDERLINE\" },\r\n  { label: \"Code\", style: \"CODE\" },\r\n  { label: \"Surprise\", style: \"ANYCUSTOMSTYLE\" },\r\n];\r\n\r\nconst ToolBar = (props) => {\r\n  var currentStyle = props.editorState.getCurrentInlineStyle();\r\n  return (\r\n    <div>\r\n      {toolbarItems.map((toolbarItem) => (\r\n        <ToolbarButton\r\n          key={toolbarItem.label}\r\n          active={currentStyle.has(toolbarItem.style)}\r\n          label={toolbarItem.label}\r\n          onToggle={props.onToggle}\r\n          style={toolbarItem.style}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst initialData = {\r\n  blocks: [\r\n    //   {\r\n    //     key: \"16d0k\",\r\n    //     text: \"You can edit this text.\",\r\n    //     type: \"unstyled\",\r\n    //     depth: 0,\r\n    //     inlineStyleRanges: [{ offset: 0, length: 23, style: \"BOLD\" }],\r\n    //     entityRanges: [],\r\n    //     data: {},\r\n    //   },\r\n    //   {\r\n    //     key: \"98peq\",\r\n    //     text: \"\",\r\n    //     type: \"unstyled\",\r\n    //     depth: 0,\r\n    //     inlineStyleRanges: [],\r\n    //     entityRanges: [],\r\n    //     data: {},\r\n    //   },\r\n    //   {\r\n    //     key: \"ecmnc\",\r\n    //     text:\r\n    //       \"Luke Skywalker has vanished. In his absence, the sinister FIRST ORDER has risen from the ashes of the Empire and will not rest until Skywalker, the last Jedi, has been destroyed.\",\r\n    //     type: \"unstyled\",\r\n    //     depth: 0,\r\n    //     inlineStyleRanges: [\r\n    //       { offset: 0, length: 14, style: \"BOLD\" },\r\n    //       { offset: 133, length: 9, style: \"BOLD\" },\r\n    //     ],\r\n    //     entityRanges: [],\r\n    //     data: {},\r\n    //   },\r\n    //   {\r\n    //     key: \"fe2gn\",\r\n    //     text: \"\",\r\n    //     type: \"unstyled\",\r\n    //     depth: 0,\r\n    //     inlineStyleRanges: [],\r\n    //     entityRanges: [],\r\n    //     data: {},\r\n    //   },\r\n    //   {\r\n    //     key: \"4481k\",\r\n    //     text:\r\n    //       \"With the support of the REPUBLIC, General Leia Organa leads a brave RESISTANCE. She is desperate to find her brother Luke and gain his help in restoring peace and justice to the galaxy.\",\r\n    //     type: \"unstyled\",\r\n    //     depth: 0,\r\n    //     inlineStyleRanges: [\r\n    //       { offset: 34, length: 19, style: \"BOLD\" },\r\n    //       { offset: 117, length: 4, style: \"BOLD\" },\r\n    //       { offset: 68, length: 10, style: \"ANYCUSTOMSTYLE\" },\r\n    //     ],\r\n    //     entityRanges: [],\r\n    //     data: {},\r\n    //   },\r\n  ],\r\n  entityMap: {},\r\n};\r\n"]},"metadata":{},"sourceType":"module"}