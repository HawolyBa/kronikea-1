{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Utilisateur\\\\Documents\\\\CODE\\\\kronikea-master\\\\hooks\\\\userHooks.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useContext, createContext } from \"react\";\nimport { auth, db } from \"../redux/fbConfig\";\nimport Router from \"next/router\";\nconst authContext = /*#__PURE__*/createContext();\nexport function ProvideAuth({\n  children\n}) {\n  const auth = useProvideAuth();\n  return __jsx(authContext.Provider, {\n    value: auth,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 9,\n      columnNumber: 10\n    }\n  }, children);\n}\nexport const useAuth = () => {\n  return useContext(authContext);\n};\n\nfunction useProvideAuth() {\n  const {\n    0: user,\n    1: setUser\n  } = useState(null);\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n  const router = Router(); // Wrap any Firebase methods we want to use making sure ...\n  // ... to save the user to state.\n\n  const signin = (email, password) => {\n    return auth.signInWithEmailAndPassword(email, password).then(response => {\n      setUser(response.user);\n      return response.user;\n    });\n  };\n\n  const signup = (email, password, username) => {\n    return auth.createUserWithEmailAndPassword(email, password).then(response => {\n      setUser(response.user);\n      db.collection(\"users\").add({\n        badges: [],\n        biography: \"\",\n        createdAt: db.FieldValue.serverTimestamp(),\n        suspended: false,\n        facebook: \"\",\n        instagram: \"\",\n        twitter: \"\",\n        deviantart: \"\",\n        likesCount: \"\",\n        username: username,\n        avatar: \"\"\n      });\n      return response.user;\n    });\n  };\n\n  const signout = () => {\n    return auth.signOut().then(() => {\n      setUser(false);\n      router.push(\"/auth\");\n    });\n  };\n\n  const sendPasswordResetEmail = email => {\n    return auth.sendPasswordResetEmail(email).then(() => {\n      return true;\n    });\n  };\n\n  const confirmPasswordReset = (code, password) => {\n    return auth.confirmPasswordReset(code, password).then(() => {\n      return true;\n    });\n  };\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      console.log(user);\n\n      if (user) {\n        setUser(user);\n        setIsLoading(false);\n      } else {\n        setUser(false);\n        setIsLoading(false);\n      }\n    }); // Cleanup subscription on unmount\n\n    return () => unsubscribe();\n  }, []); // Return the user object and auth methods\n\n  return {\n    isLoading,\n    user,\n    signin,\n    signup,\n    signout,\n    sendPasswordResetEmail,\n    confirmPasswordReset\n  };\n}","map":{"version":3,"sources":["C:/Users/Utilisateur/Documents/CODE/kronikea-master/hooks/userHooks.js"],"names":["React","useState","useEffect","useContext","createContext","auth","db","Router","authContext","ProvideAuth","children","useProvideAuth","useAuth","user","setUser","isLoading","setIsLoading","router","signin","email","password","signInWithEmailAndPassword","then","response","signup","username","createUserWithEmailAndPassword","collection","add","badges","biography","createdAt","FieldValue","serverTimestamp","suspended","facebook","instagram","twitter","deviantart","likesCount","avatar","signout","signOut","push","sendPasswordResetEmail","confirmPasswordReset","code","unsubscribe","onAuthStateChanged","console","log"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext, createContext } from \"react\";\r\nimport { auth, db } from \"../redux/fbConfig\";\r\nimport Router from \"next/router\";\r\n\r\nconst authContext = createContext();\r\n\r\nexport function ProvideAuth({ children }) {\r\n  const auth = useProvideAuth();\r\n  return <authContext.Provider value={auth}>{children}</authContext.Provider>;\r\n}\r\n\r\nexport const useAuth = () => {\r\n  return useContext(authContext);\r\n};\r\n\r\nfunction useProvideAuth() {\r\n  const [user, setUser] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const router = Router();\r\n\r\n  // Wrap any Firebase methods we want to use making sure ...\r\n  // ... to save the user to state.\r\n  const signin = (email, password) => {\r\n    return auth.signInWithEmailAndPassword(email, password).then((response) => {\r\n      setUser(response.user);\r\n      return response.user;\r\n    });\r\n  };\r\n\r\n  const signup = (email, password, username) => {\r\n    return auth\r\n      .createUserWithEmailAndPassword(email, password)\r\n      .then((response) => {\r\n        setUser(response.user);\r\n        db.collection(\"users\").add({\r\n          badges: [],\r\n          biography: \"\",\r\n          createdAt: db.FieldValue.serverTimestamp(),\r\n          suspended: false,\r\n          facebook: \"\",\r\n          instagram: \"\",\r\n          twitter: \"\",\r\n          deviantart: \"\",\r\n          likesCount: \"\",\r\n          username: username,\r\n          avatar: \"\",\r\n        });\r\n        return response.user;\r\n      });\r\n  };\r\n\r\n  const signout = () => {\r\n    return auth.signOut().then(() => {\r\n      setUser(false);\r\n      router.push(\"/auth\");\r\n    });\r\n  };\r\n\r\n  const sendPasswordResetEmail = (email) => {\r\n    return auth.sendPasswordResetEmail(email).then(() => {\r\n      return true;\r\n    });\r\n  };\r\n\r\n  const confirmPasswordReset = (code, password) => {\r\n    return auth.confirmPasswordReset(code, password).then(() => {\r\n      return true;\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = auth.onAuthStateChanged((user) => {\r\n      console.log(user);\r\n      if (user) {\r\n        setUser(user);\r\n        setIsLoading(false);\r\n      } else {\r\n        setUser(false);\r\n        setIsLoading(false);\r\n      }\r\n    });\r\n\r\n    // Cleanup subscription on unmount\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  // Return the user object and auth methods\r\n  return {\r\n    isLoading,\r\n    user,\r\n    signin,\r\n    signup,\r\n    signout,\r\n    sendPasswordResetEmail,\r\n    confirmPasswordReset,\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}