{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Utilisateur\\\\Documents\\\\CODE\\\\kronikea-master\\\\pages\\\\profile\\\\index.js\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { useRouter } from \"next/router\";\nimport { Alert, Button } from \"antd\";\nimport Banner from \"../../components/profile/Banner\";\nimport Tabs from \"../../components/profile/Tabs\";\nimport Stories from \"../../components/profile/Stories\";\nimport Characters from \"../../components/profile/Characters\";\nimport Followers from \"../../components/profile/Followers\";\nimport Locations from \"../../components/profile/Locations\";\nimport Settings from \"../../components/profile/Settings\";\nimport { getProfile, changeProfile } from \"../../redux/actions/userActions\";\nimport { getUserStories, getFavoriteStories, getUserLocations } from \"../../redux/actions/storiesActions\";\nimport { getUserCharacters, getFavoriteCharacters } from \"../../redux/actions/charactersActions\";\nimport { getFavoriteAuthors, getFollowers } from \"../../redux/actions/userActions\";\nimport { useAuth } from \"../../hooks/userHooks\";\nimport LoadingScreen from \"../../components/hoc/LoadingScreen\";\nimport RedirectComp from \"../../components/hoc/RedirectComp\";\n\nconst Profile = ({\n  getProfile,\n  profile,\n  stories,\n  locations,\n  getUserStories,\n  getUserCharacters,\n  getFavoriteAuthors,\n  getFavoriteCharacters,\n  getFavoriteStories,\n  getUserLocations,\n  changeProfile,\n  getFollowers,\n  characters,\n  favAuthors,\n  followers,\n  favCharacters,\n  favStories,\n  loading\n}) => {\n  const {\n    0: tabs\n  } = useState([\"stories\", \"characters\", \"locations\", \"favorites stories\", \"favorites characters\", \"followers\", \"followings\"]);\n  const {\n    0: openSettings,\n    1: setOpenSettings\n  } = useState(false);\n  const {\n    0: currentTab,\n    1: setCurrentTab\n  } = useState(\"stories\");\n  const {\n    0: favTab,\n    1: setFavTab\n  } = useState(\"favauthors\");\n  const {\n    0: favoriteStories,\n    1: setFavoriteStories\n  } = useState([]);\n  const {\n    0: favoriteCharacters,\n    1: setFavoriteCharacters\n  } = useState(favCharacters);\n\n  const changeTab = tab => setCurrentTab(tab);\n\n  const auth = useAuth();\n  const router = useRouter();\n  useEffect(() => {\n    const unsubscribe = () => {\n      if (auth.user) {\n        getProfile();\n        getUserStories(null, \"profile\");\n        getUserCharacters();\n        getFavoriteAuthors();\n        getFollowers();\n        getFavoriteCharacters();\n        getFavoriteStories();\n        getUserLocations();\n      }\n    };\n\n    return unsubscribe();\n  }, [auth]);\n  useEffect(() => {\n    setFavoriteStories(favStories.filter(s => s.public || s.authorId === auth.user.uid));\n    setFavoriteCharacters(favCharacters.filter(s => s.public || s.authorId === auth.user.uid));\n  }, [auth, favStories, favCharacters]);\n\n  const changeFavTab = tab => setFavTab(tab);\n\n  const deleteAccount = () => {\n    auth.deleteAccount();\n    router.push(\"/\");\n  };\n\n  return __jsx(\"div\", {\n    className: \"profile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 5\n    }\n  }, __jsx(LoadingScreen, {\n    loading: auth.isLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, __jsx(RedirectComp, {\n    condition: auth.user,\n    type: \"redirect\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }\n  }, auth.user && !auth.user.emailVerified && __jsx(React.Fragment, null, __jsx(Alert, {\n    closable: true,\n    message: \"You need to verify your email to enjoy all benefits of Kronikea\",\n    type: \"error\",\n    action: __jsx(Button, {\n      size: \"small\",\n      type: \"primary\",\n      onClick: auth.verifyEmail,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 19\n      }\n    }, \"Click here to send a new email\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 15\n    }\n  }), __jsx(\"div\", {\n    style: {\n      marginBottom: \"24px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 15\n    }\n  })), __jsx(Banner, {\n    context: \"private\",\n    profile: profile,\n    openSettings: setOpenSettings,\n    favAuthors: favAuthors,\n    followers: followers,\n    changeFavTab: changeFavTab,\n    favTab: favTab,\n    setCurrentTab: setCurrentTab,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }), __jsx(\"section\", {\n    className: \"profile-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }, __jsx(Tabs, {\n    currentTab: currentTab,\n    tabs: tabs,\n    changeTab: changeTab,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }), currentTab === \"stories\" && __jsx(Stories, {\n    auth: auth,\n    loading: loading,\n    type: \"show\",\n    stories: stories,\n    type: \"privateProfile\",\n    context: \"private\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 15\n    }\n  }), currentTab === \"characters\" && __jsx(Characters, {\n    context: \"private\",\n    characters: characters,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 15\n    }\n  }), currentTab === \"locations\" && __jsx(Locations, {\n    context: \"private\",\n    locations: locations,\n    type: \"profile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 15\n    }\n  }), currentTab === \"favorites stories\" && __jsx(Stories, {\n    loading: loading,\n    type: \"favorites\",\n    stories: favoriteStories,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 15\n    }\n  }), currentTab === \"favorites characters\" && __jsx(Characters, {\n    type: \"favorites\",\n    characters: favoriteCharacters,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 15\n    }\n  }), currentTab === \"followers\" && __jsx(Followers, {\n    title: favAuthors.authors.length > 1 ? \"Followers\" : \"Follower\",\n    type: \"followers\",\n    lg: 4,\n    md: 6,\n    sm: 8,\n    xs: 12,\n    items: followers.authors,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 15\n    }\n  }), currentTab === \"followings\" && __jsx(Followers, {\n    title: favAuthors.authors.length > 1 ? \"Followings\" : \"Following\",\n    type: \"followings\",\n    lg: 4,\n    md: 6,\n    sm: 8,\n    xs: 12,\n    items: favAuthors.authors,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 15\n    }\n  })), __jsx(Settings, {\n    deleteAccount: auth.deleteAccount,\n    changeProfile: changeProfile,\n    profile: profile,\n    openSettings: openSettings,\n    setOpenSettings: setOpenSettings,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }))));\n};\n\nconst mapStateToProps = (state, ownProps) => ({\n  profile: state.auth.profile,\n  stories: state.stories.userStories,\n  characters: state.characters.userCharacters,\n  favAuthors: state.auth.favAuthors,\n  followers: state.auth.followers,\n  favCharacters: state.characters.favCharacters,\n  favStories: state.stories.favStories,\n  locations: state.stories.userLocations,\n  loading: state.stories.loading\n});\n\nexport default connect(mapStateToProps, {\n  getProfile,\n  getUserStories,\n  getUserCharacters,\n  getFavoriteAuthors,\n  getFollowers,\n  getFavoriteCharacters,\n  getFavoriteStories,\n  getUserLocations,\n  changeProfile\n})(Profile);","map":{"version":3,"sources":["C:/Users/Utilisateur/Documents/CODE/kronikea-master/pages/profile/index.js"],"names":["React","useEffect","useState","connect","useRouter","Alert","Button","Banner","Tabs","Stories","Characters","Followers","Locations","Settings","getProfile","changeProfile","getUserStories","getFavoriteStories","getUserLocations","getUserCharacters","getFavoriteCharacters","getFavoriteAuthors","getFollowers","useAuth","LoadingScreen","RedirectComp","Profile","profile","stories","locations","characters","favAuthors","followers","favCharacters","favStories","loading","tabs","openSettings","setOpenSettings","currentTab","setCurrentTab","favTab","setFavTab","favoriteStories","setFavoriteStories","favoriteCharacters","setFavoriteCharacters","changeTab","tab","auth","router","unsubscribe","user","filter","s","public","authorId","uid","changeFavTab","deleteAccount","push","isLoading","emailVerified","verifyEmail","marginBottom","authors","length","mapStateToProps","state","ownProps","userStories","userCharacters","userLocations"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useRouter } from \"next/router\";\r\nimport { Alert, Button } from \"antd\";\r\n\r\nimport Banner from \"../../components/profile/Banner\";\r\nimport Tabs from \"../../components/profile/Tabs\";\r\nimport Stories from \"../../components/profile/Stories\";\r\nimport Characters from \"../../components/profile/Characters\";\r\nimport Followers from \"../../components/profile/Followers\";\r\nimport Locations from \"../../components/profile/Locations\";\r\nimport Settings from \"../../components/profile/Settings\";\r\n\r\nimport { getProfile, changeProfile } from \"../../redux/actions/userActions\";\r\nimport {\r\n  getUserStories,\r\n  getFavoriteStories,\r\n  getUserLocations,\r\n} from \"../../redux/actions/storiesActions\";\r\nimport {\r\n  getUserCharacters,\r\n  getFavoriteCharacters,\r\n} from \"../../redux/actions/charactersActions\";\r\nimport {\r\n  getFavoriteAuthors,\r\n  getFollowers,\r\n} from \"../../redux/actions/userActions\";\r\nimport { useAuth } from \"../../hooks/userHooks\";\r\nimport LoadingScreen from \"../../components/hoc/LoadingScreen\";\r\nimport RedirectComp from \"../../components/hoc/RedirectComp\";\r\n\r\nconst Profile = ({\r\n  getProfile,\r\n  profile,\r\n  stories,\r\n  locations,\r\n  getUserStories,\r\n  getUserCharacters,\r\n  getFavoriteAuthors,\r\n  getFavoriteCharacters,\r\n  getFavoriteStories,\r\n  getUserLocations,\r\n  changeProfile,\r\n  getFollowers,\r\n  characters,\r\n  favAuthors,\r\n  followers,\r\n  favCharacters,\r\n  favStories,\r\n  loading,\r\n}) => {\r\n  const [tabs] = useState([\r\n    \"stories\",\r\n    \"characters\",\r\n    \"locations\",\r\n    \"favorites stories\",\r\n    \"favorites characters\",\r\n    \"followers\",\r\n    \"followings\",\r\n  ]);\r\n  const [openSettings, setOpenSettings] = useState(false);\r\n  const [currentTab, setCurrentTab] = useState(\"stories\");\r\n  const [favTab, setFavTab] = useState(\"favauthors\");\r\n  const [favoriteStories, setFavoriteStories] = useState([]);\r\n  const [favoriteCharacters, setFavoriteCharacters] = useState(favCharacters);\r\n  const changeTab = (tab) => setCurrentTab(tab);\r\n\r\n  const auth = useAuth();\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = () => {\r\n      if (auth.user) {\r\n        getProfile();\r\n        getUserStories(null, \"profile\");\r\n        getUserCharacters();\r\n        getFavoriteAuthors();\r\n        getFollowers();\r\n        getFavoriteCharacters();\r\n        getFavoriteStories();\r\n        getUserLocations();\r\n      }\r\n    };\r\n    return unsubscribe();\r\n  }, [auth]);\r\n\r\n  useEffect(() => {\r\n    setFavoriteStories(\r\n      favStories.filter((s) => s.public || s.authorId === auth.user.uid)\r\n    );\r\n    setFavoriteCharacters(\r\n      favCharacters.filter((s) => s.public || s.authorId === auth.user.uid)\r\n    );\r\n  }, [auth, favStories, favCharacters]);\r\n\r\n  const changeFavTab = (tab) => setFavTab(tab);\r\n\r\n  const deleteAccount = () => {\r\n    auth.deleteAccount();\r\n    router.push(\"/\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"profile\">\r\n      <LoadingScreen loading={auth.isLoading}>\r\n        <RedirectComp condition={auth.user} type=\"redirect\">\r\n          {auth.user && !auth.user.emailVerified && (\r\n            <>\r\n              <Alert\r\n                closable\r\n                message=\"You need to verify your email to enjoy all benefits of Kronikea\"\r\n                type=\"error\"\r\n                action={\r\n                  <Button\r\n                    size=\"small\"\r\n                    type=\"primary\"\r\n                    onClick={auth.verifyEmail}\r\n                  >\r\n                    Click here to send a new email\r\n                  </Button>\r\n                }\r\n              />\r\n              <div style={{ marginBottom: \"24px\" }}></div>\r\n            </>\r\n          )}\r\n          <Banner\r\n            context=\"private\"\r\n            profile={profile}\r\n            openSettings={setOpenSettings}\r\n            favAuthors={favAuthors}\r\n            followers={followers}\r\n            changeFavTab={changeFavTab}\r\n            favTab={favTab}\r\n            setCurrentTab={setCurrentTab}\r\n          />\r\n          <section className=\"profile-content\">\r\n            <Tabs currentTab={currentTab} tabs={tabs} changeTab={changeTab} />\r\n            {currentTab === \"stories\" && (\r\n              <Stories\r\n                auth={auth}\r\n                loading={loading}\r\n                type={\"show\"}\r\n                stories={stories}\r\n                type={\"privateProfile\"}\r\n                context=\"private\"\r\n              />\r\n            )}\r\n            {currentTab === \"characters\" && (\r\n              <Characters context=\"private\" characters={characters} />\r\n            )}\r\n            {currentTab === \"locations\" && (\r\n              <Locations\r\n                context=\"private\"\r\n                locations={locations}\r\n                type=\"profile\"\r\n              />\r\n            )}\r\n            {currentTab === \"favorites stories\" && (\r\n              <Stories\r\n                loading={loading}\r\n                type=\"favorites\"\r\n                stories={favoriteStories}\r\n              />\r\n            )}\r\n            {currentTab === \"favorites characters\" && (\r\n              <Characters type=\"favorites\" characters={favoriteCharacters} />\r\n            )}\r\n            {currentTab === \"followers\" && (\r\n              <Followers\r\n                title={favAuthors.authors.length > 1 ? \"Followers\" : \"Follower\"}\r\n                type={\"followers\"}\r\n                lg={4}\r\n                md={6}\r\n                sm={8}\r\n                xs={12}\r\n                items={followers.authors}\r\n              />\r\n            )}\r\n            {currentTab === \"followings\" && (\r\n              <Followers\r\n                title={\r\n                  favAuthors.authors.length > 1 ? \"Followings\" : \"Following\"\r\n                }\r\n                type={\"followings\"}\r\n                lg={4}\r\n                md={6}\r\n                sm={8}\r\n                xs={12}\r\n                items={favAuthors.authors}\r\n              />\r\n            )}\r\n          </section>\r\n          <Settings\r\n            deleteAccount={auth.deleteAccount}\r\n            changeProfile={changeProfile}\r\n            profile={profile}\r\n            openSettings={openSettings}\r\n            setOpenSettings={setOpenSettings}\r\n          />\r\n        </RedirectComp>\r\n      </LoadingScreen>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n  profile: state.auth.profile,\r\n  stories: state.stories.userStories,\r\n  characters: state.characters.userCharacters,\r\n  favAuthors: state.auth.favAuthors,\r\n  followers: state.auth.followers,\r\n  favCharacters: state.characters.favCharacters,\r\n  favStories: state.stories.favStories,\r\n  locations: state.stories.userLocations,\r\n  loading: state.stories.loading,\r\n});\r\n\r\nexport default connect(mapStateToProps, {\r\n  getProfile,\r\n  getUserStories,\r\n  getUserCharacters,\r\n  getFavoriteAuthors,\r\n  getFollowers,\r\n  getFavoriteCharacters,\r\n  getFavoriteStories,\r\n  getUserLocations,\r\n  changeProfile,\r\n})(Profile);\r\n"]},"metadata":{},"sourceType":"module"}